# Inventory
- Inventory: Organise the managed nodes in a centralised file that provides Ansible with system information and network location.
- An Ansible inventory file is a fundamental component of Ansible that defines the hosts that you want to manage and the groups that the hosts belong to.

- The inventory file can be static (a simple text file) or dynamic (the script generates it). It provides Ansible with the information about the remote notes communicated during operations.

- create a file called inventory.ini in the /etc/ansible/
- add a new group [myservers] to the inventory.ini file.
- ```ini
  [myservers]
  10.135.32.51
  10.135.32.52
  ```
  ### Verify your inventory
  ```ad-hoc
  ansible-inventory -i /etc/ansible/inventory.ini --list
  ```
  ### Ping to the ```myservers``` group in your inventory
  ```
  ansible -i inventory.ini -m ping myservers
  ``` 

  ### Static Inventory

  - A static inventory file is typically a plain text file that usually stores the hosts or inventory in INI or YAML format.
```ini
[all]
10.135.64.101
10.135.64.102

[web servers]
web1.example.com
web2.example.com

[all:vars]
ansible_user=ubuntu
ansible_password=ubuntu
```

### YAML
```yaml
all:
  vars:
    ansible_user : admin
    ansible_ssh_private_key: /path/to/key
  children:
      webservers:
        hosts:
          web1.example.com
          web2.example.com
      dbservers:
        hosts:
          db1.example.com
          db2.example.com
```

## Dynamic Inventory

- A dynamic inventory is generated by a script or plugin and can be used for environments where the hosts are constantly changing
- The script or plugin fetches the list of hosts from a source like AWS,GCP or any other dynamic source

```python
#!/usr/bin/env python

import json
import boto3

def get_aws_ec2_inventory():
    ec2 = boto3.client('ec2')
    instances = ec2.describe_instances()
    inventory = {
        'all': {
            'hosts': [],
            'vars': {
                'ansible_user': 'ec2-user',
                'ansible_ssh_private_key_file': '/path/to/key'
            }
        },
        '_meta': {
            'hostvars': {}
        }
    }

    for reservation in instances['Reservations']:
        for instance in reservation['Instances']:
            if instance['State']['Name'] == 'running':
                public_ip = instance['PublicIpAddress']
                inventory['all']['hosts'].append(public_ip)
                inventory['_meta']['hostvars'][public_ip] = {
                    'ansible_host': public_ip
                }

    print(json.dumps(inventory, indent=2))

if __name__ == '__main__':
    get_aws_ec2_inventory()
``` 
